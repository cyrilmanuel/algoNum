<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8"/>
		<title> Labo1- Convertisseur</title>
	</head>
	
	<body>
		<h1>Convertisseur Decimal - Binaire</h1>
		<p>
		<label for="nBit">Codage sur </label> 
		<input type="number" name="nBit" id="nBit" value="8"/>
		bits.
		</P>
		<p>
		<label for="nb1">Premier nombre à convertir: </label>
		<input type="number" name="nb1" id="nb1" value="0"/><sub>10</sub>
		<input type="text" name="bin1" id="bin1" /><sub>2</sub>
		</p>
		<p>
		<button type="button" name="conv1" id="conv1">Decimal -> Binaire</button>
		<button type="button" name="conve1" id="conve1">Binaire -> Decimal</button>
		</p>
		<p>
		<label for="nb2">Second nombre à convertir: </label>
		<input type="number" name="nb2" id="nb2" value="0"/><sub>10</sub>
		<input type="text" name="bin2" id="bin2" /><sub>2</sub>
		</p>
		<p>
		<button type="button" name="conv2" id="conv2">Decimal -> Binaire</button>
		<button type="buton" name="conve2" id="conve2">Binaire -> Decimal</button>
		</p>
		<p>
		<label for="add">Opération entre les nombres:</label>
		<button type="button" name="add" id="add">Addition</button>
		<button type="button" name="sous" id="sous">Soustraction</button>
		<button type="button" name="mult" id="mult">Multiplication</button>
		</p>
		<p>
		Résultat du calcul: 
		<input type="number" name="resDec" id="resDec" value="0" disabled/><sub>10</sub>
		&lt;=&gt;
		<input type="text" name="resBin" id="resBin" disabled/><sub>2</sub>
		</p>
		<script>
		document.getElementById("conv1").addEventListener("click", function(){
			decimalToBinary(1);
		});

		document.getElementById("conve1").addEventListener("click", function(){
			binaryToDecimal(1);
		});
		
		document.getElementById("conv2").addEventListener("click",function(){
			decimalToBinary(2);
		});
		
		document.getElementById("conve2").addEventListener("click",function(){
			binaryToDecimal(2);
		});

		document.getElementById("add").addEventListener("click", function(){
			addition();
		});

		document.getElementById("sous").addEventListener("click", function(){
			soustraction();
		});

		document.getElementById("mult").addEventListener("click", function(){
			multiplication();
		});

		document.getElementById("nb1").addEventListener("change", function(){
			decimalToBinary(1);
		});

		document.getElementById("nb2").addEventListener("change", function(){
			decimalToBinary(2);
		});

		document.getElementById("bin1").addEventListener("change", function(){
			binaryToDecimal(1);
		});

		document.getElementById("bin2").addEventListener("change", function(){
			binaryToDecimal(2);
		});

		
		function decimalToBinary(id){
			var nbaconvertir = document.getElementById("nb"+id).value;
			var nbBit = document.getElementById("nBit").value;
			var res = [];
			var quotient = 1;
			var i = 0; 
			
			if(nbaconvertir >=0){
				while(quotient !== 0){
					quotient = parseInt(nbaconvertir / 2);
					res[i] = nbaconvertir % 2;
					nbaconvertir = quotient;
					i++;
				}
			}
			
			if(res.length <= nbBit){
				for(i = res.length; i < nbBit; i++){
					res[i] = 0;
				}
				document.getElementById("bin"+id).value = res.reverse().join("");
			}
			else{
				alert("Erreur: nombre de bit trop faible");
			}
		}
		
		function binaryToDecimal(id){
			var nbaconvertir = document.getElementById("bin"+id).value;
			var tabBinaire = nbaconvertir.split("").reverse();
			var result = 0;
			
			for(var i = 0; i < tabBinaire.length; i++){
				if(tabBinaire[i]==1 || tabBinaire[i]==0){
					result += tabBinaire[i] * Math.pow(2,i);
				}
				else{
					alert("Veuillez entrer une valeur binaire !");
					return false;
				}
			}
			document.getElementById("nb"+id).value = result;
		}

		function addition(){
			var nbDec1= parseInt(document.getElementById("nb1").value);
			var nbDec2= parseInt(document.getElementById("nb2").value);
			var resDec= nbDec1 + nbDec2;
			document.getElementById("resDec").value = resDec;

            var nbaconvertir = document.getElementById("bin"+id).value;
            var tabBinaire = nbaconvertir.split("").reverse();

		}

		function soustraction(){
			var nbDec1 = parseInt(document.getElementById("nb1").value);
			var nbDec2 = parseInt(document.getElementById("nb2").value);
			var resDec = nbDec1 - nbDec2;
			document.getElementById("resDec").value = resDec;		
		}

		function multiplication(){
			var nbDec1 = parseInt(document.getElementById("nb1").value);
			var nbDec2 = parseInt(document.getElementById("nb2").value);
			var resDec = nbDec1 * nbDec2;
			document.getElementById("resDec").value = resDec;			
		}
		</script>
	</body>
</html>
